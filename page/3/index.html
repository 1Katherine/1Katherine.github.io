<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"1katherine.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Yang的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Yang&#39;s Blog">
<meta property="og:url" content="https://1katherine.github.io/page/3/index.html">
<meta property="og:site_name" content="Yang&#39;s Blog">
<meta property="og:description" content="Yang的博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Yang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://1katherine.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Yang's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Yang's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>guestbook</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yang</p>
  <div class="site-description" itemprop="description">Yang的博客</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/31/%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/31/%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">面试题-回调函数、闭包、回调地狱、Promise、Async、Await、指针函数（this）</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-07-31 09:31:33 / 修改时间：23:20:44" itemprop="dateCreated datePublished" datetime="2022-07-31T09:31:33+08:00">2022-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">前端面试</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>h</p>
<h2 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h2><p>【回调函数作为其他函数的参数】</p>
<p>当一个函数作为另一个函数的参数，传给另一个函数调用，这个作为参数的函数就是回调函数。</p>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>[将一个函数在另一个函数中定义并返回这个函数] 使用闭包能够访问函数作用域中的变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数内部分函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">			<span class="variable language_">console</span>.<span class="title function_">log</span>(++i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将函数做为返回值</span></span><br><span class="line">    <span class="keyword">return</span> bar;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// fn 即为闭包函数</span></span><br><span class="line">  <span class="keyword">let</span> fn = <span class="title function_">foo</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">fn</span>(); <span class="comment">// 1</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<p>闭包：一个作用域有权访问另外一个作用域的局部变量，</p>
<p>好处：可以把一个变量使用范围延伸</p>
<ol>
<li>闭包本质仍是函数，只不是从函数内部返回的</li>
<li>闭包能够创建外部可访问的隔离作用域，避免全局变量污染</li>
<li>过度使用闭包可能造成内存泄漏</li>
</ol>
<p>注：回调函数也能访问函数内部的局部变量。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/30/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86-%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF-bus-%E5%85%84%E5%BC%9F%E9%97%B4%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/30/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86-%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF-bus-%E5%85%84%E5%BC%9F%E9%97%B4%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">项目知识 - 事件总线 bus 兄弟间通信</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-07-30 20:51:18 / 修改时间：22:11:05" itemprop="dateCreated datePublished" datetime="2022-07-30T20:51:18+08:00">2022-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>当前项目使用tagsView实现多页签效果，并且对已打开的所有多页签使用缓存，避免多次发请求。但是页面之间又是相关关联的，页面A更新后，需要通知页面B重新获取数据。A、B之间的关系可能是父子 ，可能是兄弟，也可能是祖先。因此，采用BUS事件总线实现。</p>
<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><h4 id="新增util-x2F-bus-js-用于导出事件总线"><a href="#新增util-x2F-bus-js-用于导出事件总线" class="headerlink" title="新增util&#x2F;bus.js 用于导出事件总线"></a>新增util&#x2F;bus.js 用于导出事件总线</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 创建事件总线</span><br><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">export const EventBus = new Vue()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="发送事件组件"><a href="#发送事件组件" class="headerlink" title="发送事件组件"></a>发送事件组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#123; EventBus &#125; from &#x27;@/utils/bus&#x27;</span><br><span class="line"></span><br><span class="line">// 通知学校一级学科页面刷新</span><br><span class="line">EventBus.$emit(&#x27;refreshSchoolSubjects&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="接收事件组件"><a href="#接收事件组件" class="headerlink" title="接收事件组件"></a>接收事件组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import &#123; EventBus &#125; from &#x27;@/utils/bus&#x27;</span><br><span class="line"></span><br><span class="line">  mounted() &#123;</span><br><span class="line">    EventBus.$on(&#x27;refreshSchoolSubjects&#x27;, () =&gt; &#123;</span><br><span class="line">      this.getSchoolSubjectsByPageByConditions()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/30/%E9%A1%B9%E7%9B%AE-PC%E9%80%82%E9%85%8D-vue-config-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/30/%E9%A1%B9%E7%9B%AE-PC%E9%80%82%E9%85%8D-vue-config-js/" class="post-title-link" itemprop="url">项目 - PC适配 - vue.config.js</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-07-30 11:24:11 / 修改时间：12:01:09" itemprop="dateCreated datePublished" datetime="2022-07-30T11:24:11+08:00">2022-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>【vue2.0项目PC端随屏幕分辨率与窗口大小自适应】<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47416539/article/details/125032479">https://blog.csdn.net/weixin_47416539/article/details/125032479</a></li>
<li>【vue+px2rem实现pc端大屏自适应(rem适配)】<a target="_blank" rel="noopener" href="https://codeantenna.com/a/G4TWS25Sdt">https://codeantenna.com/a/G4TWS25Sdt</a></li>
</ol>
<h2 id="PC端适配问题"><a href="#PC端适配问题" class="headerlink" title="PC端适配问题"></a>PC端适配问题</h2><p>用于解决最小化浏览器窗口时，字体和样式大小不变，导致的页面混乱问题。</p>
<p>解决方式，将px转换为rem</p>
<h3 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h3><h4 id="在根目录src中新建utils目录下新建rem-js等比适配文件"><a href="#在根目录src中新建utils目录下新建rem-js等比适配文件" class="headerlink" title="在根目录src中新建utils目录下新建rem.js等比适配文件"></a>在根目录src中新建utils目录下新建rem.js等比适配文件</h4><p>我使用的最大放大比例为1 ，呵呵，效果不错！需要自己调试，选出一个合适的值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rem等比适配配置文件</span></span><br><span class="line"><span class="comment">// 基准大小</span></span><br><span class="line"><span class="keyword">const</span> baseSize = <span class="number">16</span></span><br><span class="line"><span class="comment">// 设置 rem 函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setRem</span> () &#123;</span><br><span class="line">  <span class="comment">// 当前页面屏幕分辨率相对于 1920宽的缩放比例，可根据自己需要修改</span></span><br><span class="line">  <span class="keyword">const</span> scale = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span> / <span class="number">1920</span></span><br><span class="line">  <span class="comment">// 设置页面根节点字体大小（“Math.min(scale, 2)” 指最高放大比例为2，可根据实际业务需求调整）</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">fontSize</span> = baseSize * <span class="title class_">Math</span>.<span class="title function_">min</span>(scale, <span class="number">1</span>) + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line"><span class="title function_">setRem</span>()</span><br><span class="line"><span class="comment">// 改变窗口大小时重新设置 rem</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onresize</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">setRem</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="在main-js中引入适配文件"><a href="#在main-js中引入适配文件" class="headerlink" title="在main.js中引入适配文件"></a>在main.js中引入适配文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;./utils/rem.js&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="安装postcss-pxtorem"><a href="#安装postcss-pxtorem" class="headerlink" title="安装postcss-pxtorem"></a>安装postcss-pxtorem</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i postcss-pxtorem@5.1.1 -D</span><br></pre></td></tr></table></figure>

<h4 id="在vue-config-js内配置"><a href="#在vue-config-js内配置" class="headerlink" title="在vue.config.js内配置"></a>在vue.config.js内配置</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">css</span>: &#123;</span><br><span class="line">            <span class="attr">loaderOptions</span>: &#123;</span><br><span class="line">              <span class="attr">postcss</span>: &#123;</span><br><span class="line">                <span class="attr">plugins</span>: [</span><br><span class="line">                  <span class="built_in">require</span>(<span class="string">&#x27;postcss-pxtorem&#x27;</span>)(&#123;</span><br><span class="line">                    rootValue : <span class="number">16</span>, <span class="comment">// 换算的基数</span></span><br><span class="line">                    selectorBlackList  : [], <span class="comment">// 忽略转换正则匹配项 列入一些ui库, [&#x27;.el&#x27;] 就是忽略elementUI库</span></span><br><span class="line">                    propList   : [<span class="string">&#x27;*&#x27;</span>],</span><br><span class="line">                  &#125;),</span><br><span class="line">                ]</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="PC端禁止用户缩放页面"><a href="#PC端禁止用户缩放页面" class="headerlink" title="PC端禁止用户缩放页面"></a>PC端禁止用户缩放页面</h2><p>用于禁止移动端双指缩放页面，和PC端ctrl+滚轮缩放页面</p>
<h3 id="实现步骤-1"><a href="#实现步骤-1" class="headerlink" title="实现步骤"></a>实现步骤</h3><h4 id="对于移动端"><a href="#对于移动端" class="headerlink" title="对于移动端"></a>对于移动端</h4><p>‘可以在<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=index&spm=1001.2101.3001.7020">index</a>.html中增加如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0,maximum-scale=1.0, user-scalable=no&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="对于PC端：禁止ctrl-鼠标滚轮缩放"><a href="#对于PC端：禁止ctrl-鼠标滚轮缩放" class="headerlink" title="对于PC端：禁止ctrl+鼠标滚轮缩放"></a>对于PC端：禁止ctrl+鼠标滚轮缩放</h4><p>可以在<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=index&spm=1001.2101.3001.7020">index</a>.html中增加如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousewheel&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line"> </span><br><span class="line">      e = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> ((e.<span class="property">wheelDelta</span> &amp;&amp; event.<span class="property">ctrlKey</span>) || e.<span class="property">detail</span>) &#123;</span><br><span class="line"> </span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line"> </span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;, &#123;</span><br><span class="line"> </span><br><span class="line">      <span class="attr">capture</span>: <span class="literal">false</span>,</span><br><span class="line"> </span><br><span class="line">      <span class="attr">passive</span>: <span class="literal">false</span></span><br><span class="line"> </span><br><span class="line">    &#125;);</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">if</span> ((event.<span class="property">ctrlKey</span> === <span class="literal">true</span> || event.<span class="property">metaKey</span> === <span class="literal">true</span>)</span><br><span class="line"> </span><br><span class="line">        &amp;&amp; (event.<span class="property">keyCode</span> === <span class="number">61</span> || event.<span class="property">keyCode</span> === <span class="number">107</span></span><br><span class="line"> </span><br><span class="line">          || event.<span class="property">keyCode</span> === <span class="number">173</span> || event.<span class="property">keyCode</span> === <span class="number">109</span></span><br><span class="line"> </span><br><span class="line">          || event.<span class="property">keyCode</span> === <span class="number">187</span> || event.<span class="property">keyCode</span> === <span class="number">189</span>)) &#123;</span><br><span class="line"> </span><br><span class="line">        event.<span class="title function_">preventDefault</span>();</span><br><span class="line"> </span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;, <span class="literal">false</span>);</span><br><span class="line"> </span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/28/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/28/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-28 10:45:29" itemprop="dateCreated datePublished" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/27/vuex%E5%9F%BA%E7%A1%80-store%E3%80%81state%E3%80%81mutations%E3%80%81actions%E3%80%81%E5%B1%80%E9%83%A8%E4%BD%9C%E7%94%A8%E5%9F%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/27/vuex%E5%9F%BA%E7%A1%80-store%E3%80%81state%E3%80%81mutations%E3%80%81actions%E3%80%81%E5%B1%80%E9%83%A8%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="post-title-link" itemprop="url">vuex基础 - store、state、mutations、actions、局部作用域</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-27 10:23:52" itemprop="dateCreated datePublished" datetime="2022-07-27T10:23:52+08:00">2022-07-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><ol>
<li>修改state状态必须通过**<code>mutations</code>**</li>
<li>**<code>mutations</code>**只能执行同步代码，类似ajax，定时器之类的代码不能在mutations中执行</li>
<li>执行异步代码，要通过**<code>actions</code>**，然后将数据提交给mutations才可以完成数据更新</li>
<li>state的状态即共享数据可以在组件中引用</li>
<li>组件中可以调用 state 、mutations、 actions</li>
</ol>
<h2 id="vuex初始化"><a href="#vuex初始化" class="headerlink" title="vuex初始化"></a>vuex初始化</h2><ol>
<li><p>创建vue demo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create  demo</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装到**<code>运行时依赖</code>**</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vuex --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>在main.js中注册vuex</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;&#125;)</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">  store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="state"><a href="#state" class="headerlink" title="state"></a>state</h2><h3 id="定义state"><a href="#定义state" class="headerlink" title="定义state"></a><strong>定义state</strong></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化vuex对象</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="comment">// 管理数据</span></span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="在组件中获取state"><a href="#在组件中获取state" class="headerlink" title="在组件中获取state"></a>在组件中获取state</h3><h4 id="插值表达式-store-state"><a href="#插值表达式-store-state" class="headerlink" title="插值表达式 $store.state"></a>插值表达式 $store.state</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt; state的数据：&#123;&#123; $store.state.count &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把state中数据，定义在组件内的计算属性中</span></span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    count () &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">count</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> &lt;div&gt; state的数据：&#123;&#123; count &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="辅助函数-mapState"><a href="#辅助函数-mapState" class="headerlink" title="辅助函数 - mapState"></a>辅助函数 - mapState</h4><p>第一步：导入mapState</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; mapState &#125; from &#x27;vuex&#x27;</span><br></pre></td></tr></table></figure>

<p>第二步：采用数组形式引入state属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mapState</span>([<span class="string">&#x27;count&#x27;</span>]) </span><br></pre></td></tr></table></figure>

<p>第三步：利用<strong>延展运算符</strong>将导出的状态映射给计算属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  ...<span class="title function_">mapState</span>([<span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt; state的数据：&#123;&#123; count &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h2 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h2><h4 id="定义mutations"><a href="#定义mutations" class="headerlink" title="定义mutations"></a>定义mutations</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store  = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 定义mutations</span></span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">      <span class="comment">// 方法里参数 第一个参数是当前store的state属性</span></span><br><span class="line">    <span class="comment">// payload 载荷 运输参数 调用mutaiions的时候 可以传递参数 传递载荷</span></span><br><span class="line">    addCount (state, payload) &#123;</span><br><span class="line">        state.<span class="property">count</span> += payload</span><br><span class="line">    &#125;,</span><br><span class="line">    addCount2 (state) &#123;</span><br><span class="line">        state.<span class="property">count</span> += <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="在组件中调用mutations"><a href="#在组件中调用mutations" class="headerlink" title="在组件中调用mutations"></a>在组件中调用mutations</h3><h4 id="原始形式-store-commit"><a href="#原始形式-store-commit" class="headerlink" title="原始形式-$store.commit"></a><strong>原始形式</strong>-$store.commit</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;addCount&quot;&gt;+1&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">    //   调用方法</span><br><span class="line">      addCount () &#123;</span><br><span class="line">         // 调用store中的mutations 提交给muations</span><br><span class="line">        // commit(&#x27;muations名称&#x27;, 2)</span><br><span class="line">        this.$store.commit(&#x27;addCount&#x27;, 10)  // 直接调用mutations</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="辅助函数-mapMutations"><a href="#辅助函数-mapMutations" class="headerlink" title="辅助函数 - mapMutations"></a><strong>辅助函数</strong> - mapMutations</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import  &#123; mapMutations &#125; from &#x27;vuex&#x27;</span><br><span class="line">methods: &#123;</span><br><span class="line">    ...mapMutations([&#x27;addCount&#x27;])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;button @click=&quot;addCount(100)&quot;&gt;+100&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<h2 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h2><h3 id="定义actions"><a href="#定义actions" class="headerlink" title="定义actions"></a>定义actions</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line"> <span class="comment">//  获取异步的数据 context表示当前的store的实例 可以通过 context.state 获取状态 也可以通过context.commit 来提交mutations， 也可以 context.diapatch调用其他的action</span></span><br><span class="line">   getAsyncCount (context) &#123;</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="comment">// 一秒钟之后 要给一个数 去修改state</span></span><br><span class="line">       context.<span class="title function_">commit</span>(<span class="string">&#x27;addCount&#x27;</span>, <span class="number">123</span>)</span><br><span class="line">     &#125;, <span class="number">1000</span>)</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="comment">// 带参数</span></span><br><span class="line">   getAsyncCount2 (context, payload) &#123;</span><br><span class="line">     <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       <span class="comment">// 一秒钟之后 要给一个数 去修改state</span></span><br><span class="line">       context.<span class="title function_">commit</span>(<span class="string">&#x27;addCount&#x27;</span>, payload)</span><br><span class="line">     &#125;, <span class="number">1000</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="在组件中调用actions"><a href="#在组件中调用actions" class="headerlink" title="在组件中调用actions"></a>在组件中调用actions</h3><h4 id="原始调用-store-dispatch-‘actionName’-params"><a href="#原始调用-store-dispatch-‘actionName’-params" class="headerlink" title="原始调用 - $store.dispatch(‘actionName’, params)"></a><strong>原始调用</strong> - $store.dispatch(‘actionName’, params)</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无参数调用</span></span><br><span class="line"> addAsyncCount () &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;getAsyncCount&#x27;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">// 参数调用</span></span><br><span class="line"> addAsyncCount () &#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;getAsyncCount&#x27;</span>, <span class="number">123</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="辅助函数-mapActions"><a href="#辅助函数-mapActions" class="headerlink" title="辅助函数 - mapActions([])"></a>辅助函数 - mapActions([])</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; mapActions &#125; from &#x27;vuex&#x27;</span><br><span class="line">methods: &#123;</span><br><span class="line">    ...mapActions([&#x27;getAsyncCount&#x27;])</span><br><span class="line">&#125;</span><br><span class="line">// 调用</span><br><span class="line">&lt;button @click=&quot;getAsyncCount(111)&quot;&gt;+异步&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<h2 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h2><h3 id="定义getters"><a href="#定义getters" class="headerlink" title="定义getters"></a>定义getters</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">getters</span>: &#123;</span><br><span class="line">  <span class="comment">// getters函数的第一个参数是 state</span></span><br><span class="line">  <span class="comment">// 必须要有返回值</span></span><br><span class="line">   <span class="attr">filterList</span>:  <span class="function"><span class="params">state</span> =&gt;</span>  state.<span class="property">list</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item &gt; <span class="number">5</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在组件中使用getters"><a href="#在组件中使用getters" class="headerlink" title="在组件中使用getters"></a>在组件中使用getters</h3><h4 id="原始方式-store-getters"><a href="#原始方式-store-getters" class="headerlink" title="原始方式 - $store.getters"></a>原始方式 - $store.getters</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;&#123; $store.getters.filterList &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="辅助函数-mapGetters"><a href="#辅助函数-mapGetters" class="headerlink" title="辅助函数 - mapGetters([])"></a><strong>辅助函数</strong> - mapGetters([])</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    ...mapGetters([&#x27;filterList&#x27;])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> &lt;div&gt;&#123;&#123; filterList &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>



<h2 id="Vuex-模块化"><a href="#Vuex-模块化" class="headerlink" title="Vuex - 模块化"></a>Vuex - 模块化</h2><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>定义两个模块   <strong>user</strong> 和  <strong>setting</strong></p>
<p>user中管理用户的状态  token </p>
<p>setting中管理 应用的名称 name</p>
<h3 id="定义两个模块"><a href="#定义两个模块" class="headerlink" title="定义两个模块"></a>定义两个模块</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const store  = new Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    user: &#123;</span><br><span class="line">       state: &#123;</span><br><span class="line">         token: &#x27;12345&#x27;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    setting: &#123;</span><br><span class="line">      state: &#123;</span><br><span class="line">         name: &#x27;Vuex实例&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="使用-store-state-模块名称-属性名"><a href="#使用-store-state-模块名称-属性名" class="headerlink" title="使用 $store.state.模块名称.属性名"></a>使用 $store.<strong><code>state</code></strong>.<strong><code>模块名称</code></strong>.<strong><code>属性名</code></strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      &lt;div&gt;用户token &#123;&#123; $store.state.user.token &#125;&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;网站名称 &#123;&#123; $store.state.setting.name &#125;&#125;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>使用getters获取属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">getters</span>: &#123;</span><br><span class="line">  <span class="attr">token</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">user</span>.<span class="property">token</span>,</span><br><span class="line">  <span class="attr">name</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">setting</span>.<span class="property">name</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">      ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="模块化中的命名空间"><a href="#模块化中的命名空间" class="headerlink" title="模块化中的命名空间"></a>模块化中的命名空间</h3><p>默认情况下，模块内部的 action、mutation 和 getter 是注册在<strong>全局命名空间</strong>的——这样使得多个模块能够对同一 mutation 或 action 作出响应。但是，如果我们想保证内部模块的高封闭性，我们可以采用namespaced来进行设置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user</span>: &#123;</span><br><span class="line">     <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">     <span class="attr">state</span>: &#123;</span><br><span class="line">       <span class="attr">token</span>: <span class="string">&#x27;12345&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">mutations</span>: &#123;</span><br><span class="line">      <span class="comment">//  这里的state表示的是user的state</span></span><br><span class="line">       updateToken (state) &#123;</span><br><span class="line">          state.<span class="property">token</span> = <span class="number">678910</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h4 id="方案1：直接调用-带上模块的属性名路径-store-dispatch-modelName-x2F-mutationName"><a href="#方案1：直接调用-带上模块的属性名路径-store-dispatch-modelName-x2F-mutationName" class="headerlink" title="方案1：直接调用-带上模块的属性名路径$store.dispatch(modelName&#x2F;mutationName)"></a>方案1：<strong>直接调用-带上模块的属性名路径$store.dispatch(modelName&#x2F;mutationName)</strong></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test () &#123;</span><br><span class="line">   <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;user/updateToken&#x27;</span>) <span class="comment">// 直接调用方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方案2：辅助函数-带上模块的属性名路径-mapMutations-modelName-x2F-mutaionName"><a href="#方案2：辅助函数-带上模块的属性名路径-mapMutations-modelName-x2F-mutaionName" class="headerlink" title="方案2：辅助函数-带上模块的属性名路径 -mapMutations([modelName&#x2F;mutaionName])"></a>方案2：<strong>辅助函数-带上模块的属性名路径</strong> -mapMutations([modelName&#x2F;mutaionName])</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">     ...mapMutations([&#x27;user/updateToken&#x27;]),</span><br><span class="line">     test () &#123;</span><br><span class="line">         this[&#x27;user/updateToken&#x27;]()</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&lt;button @click=&quot;test&quot;&gt;修改token&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<h4 id="方案3：-createNamespacedHelpers-创建基于某个命名空间辅助函数"><a href="#方案3：-createNamespacedHelpers-创建基于某个命名空间辅助函数" class="headerlink" title="方案3： createNamespacedHelpers  创建基于某个命名空间辅助函数"></a>方案3： <strong>createNamespacedHelpers</strong>  创建基于某个命名空间辅助函数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &#123; mapGetters, createNamespacedHelpers &#125; from &#x27;vuex&#x27;</span><br><span class="line">const &#123; mapMutations &#125; = createNamespacedHelpers(&#x27;user&#x27;)</span><br><span class="line">&lt;button @click=&quot;updateToken&quot;&gt;修改token2&lt;/button&gt;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/26/excel%E5%AF%BC%E5%85%A5%E5%8A%9F%E8%83%BD-%E5%AF%BC%E5%85%A5%E5%AD%A6%E6%A0%A1%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/26/excel%E5%AF%BC%E5%85%A5%E5%8A%9F%E8%83%BD-%E5%AF%BC%E5%85%A5%E5%AD%A6%E6%A0%A1%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/" class="post-title-link" itemprop="url">excel导入功能 - 导入学校基本信息</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-26 10:09:09" itemprop="dateCreated datePublished" datetime="2022-07-26T10:09:09+08:00">2022-07-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><p>需求是给一张excel表格，提供学校的基本信息，将其批量导入后端数据库中</p>
<p>表头如下：</p>
<img src="/2022/07/26/excel%E5%AF%BC%E5%85%A5%E5%8A%9F%E8%83%BD-%E5%AF%BC%E5%85%A5%E5%AD%A6%E6%A0%A1%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/image-20220726101114066.png" class="" title="image-20220726101114066">

<h2 id="2-封装excel导入组件"><a href="#2-封装excel导入组件" class="headerlink" title="2 封装excel导入组件"></a>2 封装excel导入组件</h2><h3 id="2-1-安装xlsx包"><a href="#2-1-安装xlsx包" class="headerlink" title="2.1 安装xlsx包"></a>2.1 安装xlsx包</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i xlsx@0.16.8</span><br></pre></td></tr></table></figure>

<h3 id="2-2-创建excel组件和样式-components-x2F-UploadExcel-x2F-index-vue"><a href="#2-2-创建excel组件和样式-components-x2F-UploadExcel-x2F-index-vue" class="headerlink" title="2.2 创建excel组件和样式(components&#x2F;UploadExcel&#x2F;index.vue)"></a>2.2 创建excel组件和样式(components&#x2F;UploadExcel&#x2F;index.vue)</h3><img src="/2022/07/26/excel%E5%AF%BC%E5%85%A5%E5%8A%9F%E8%83%BD-%E5%AF%BC%E5%85%A5%E5%AD%A6%E6%A0%A1%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF/image-20220726101922096.png" class="" title="image-20220726101922096">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;upload-excel&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;btn-upload&quot;&gt;</span><br><span class="line">      &lt;el-button</span><br><span class="line">        :loading=&quot;loading&quot;</span><br><span class="line">        size=&quot;mini&quot;</span><br><span class="line">        type=&quot;primary&quot;</span><br><span class="line">        @click=&quot;handleUpload&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        点击上传</span><br><span class="line">      &lt;/el-button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;input</span><br><span class="line">      ref=&quot;excel-upload-input&quot;</span><br><span class="line">      class=&quot;excel-upload-input&quot;</span><br><span class="line">      type=&quot;file&quot;</span><br><span class="line">      accept=&quot;.xlsx, .xls&quot;</span><br><span class="line">      @change=&quot;handleClick&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;drop&quot;</span><br><span class="line">      @drop=&quot;handleDrop&quot;</span><br><span class="line">      @dragover=&quot;handleDragover&quot;</span><br><span class="line">      @dragenter=&quot;handleDragover&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-upload&quot; /&gt;</span><br><span class="line">      &lt;span&gt;将文件拖到此处&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import XLSX from &#x27;xlsx&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    beforeUpload: Function, // eslint-disable-line</span><br><span class="line">    onSuccess: Function // eslint-disable-line</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      loading: false,</span><br><span class="line">      excelData: &#123;</span><br><span class="line">        header: null,</span><br><span class="line">        results: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    generateData(&#123; header, results &#125;) &#123;</span><br><span class="line">      this.excelData.header = header</span><br><span class="line">      this.excelData.results = results</span><br><span class="line">      this.onSuccess &amp;&amp; this.onSuccess(this.excelData)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleDrop(e) &#123;</span><br><span class="line">      e.stopPropagation()</span><br><span class="line">      e.preventDefault()</span><br><span class="line">      if (this.loading) return</span><br><span class="line">      const files = e.dataTransfer.files</span><br><span class="line">      if (files.length !== 1) &#123;</span><br><span class="line">        this.$message.error(&#x27;Only support uploading one file!&#x27;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      const rawFile = files[0] // only use files[0]</span><br><span class="line">      if (!this.isExcel(rawFile)) &#123;</span><br><span class="line">        this.$message.error(</span><br><span class="line">          &#x27;Only supports upload .xlsx, .xls, .csv suffix files&#x27;</span><br><span class="line">        )</span><br><span class="line">        return false</span><br><span class="line">      &#125;</span><br><span class="line">      this.upload(rawFile)</span><br><span class="line">      e.stopPropagation()</span><br><span class="line">      e.preventDefault()</span><br><span class="line">    &#125;,</span><br><span class="line">    handleDragover(e) &#123;</span><br><span class="line">      e.stopPropagation()</span><br><span class="line">      e.preventDefault()</span><br><span class="line">      e.dataTransfer.dropEffect = &#x27;copy&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleUpload() &#123;</span><br><span class="line">      this.$refs[&#x27;excel-upload-input&#x27;].click()</span><br><span class="line">    &#125;,</span><br><span class="line">    handleClick(e) &#123;</span><br><span class="line">      const files = e.target.files</span><br><span class="line">      const rawFile = files[0] // only use files[0]</span><br><span class="line">      if (!rawFile) return</span><br><span class="line">      this.upload(rawFile)</span><br><span class="line">    &#125;,</span><br><span class="line">    upload(rawFile) &#123;</span><br><span class="line">      this.$refs[&#x27;excel-upload-input&#x27;].value = null // fix can&#x27;t select the same excel</span><br><span class="line">      if (!this.beforeUpload) &#123;</span><br><span class="line">        this.readerData(rawFile)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      const before = this.beforeUpload(rawFile)</span><br><span class="line">      if (before) &#123;</span><br><span class="line">        this.readerData(rawFile)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    readerData(rawFile) &#123;</span><br><span class="line">      this.loading = true</span><br><span class="line">      return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        const reader = new FileReader()</span><br><span class="line">        reader.onload = (e) =&gt; &#123;</span><br><span class="line">          const data = e.target.result</span><br><span class="line">          const workbook = XLSX.read(data, &#123; type: &#x27;array&#x27; &#125;)</span><br><span class="line">          const firstSheetName = workbook.SheetNames[0]</span><br><span class="line">          const worksheet = workbook.Sheets[firstSheetName]</span><br><span class="line">          const header = this.getHeaderRow(worksheet)</span><br><span class="line">          const results = XLSX.utils.sheet_to_json(worksheet)</span><br><span class="line">          this.generateData(&#123; header, results &#125;)</span><br><span class="line">          this.loading = false</span><br><span class="line">          resolve()</span><br><span class="line">        &#125;</span><br><span class="line">        reader.readAsArrayBuffer(rawFile)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    getHeaderRow(sheet) &#123;</span><br><span class="line">      const headers = []</span><br><span class="line">      const range = XLSX.utils.decode_range(sheet[&#x27;!ref&#x27;])</span><br><span class="line">      let C</span><br><span class="line">      const R = range.s.r</span><br><span class="line">      /* start in the first row */</span><br><span class="line">      for (C = range.s.c; C &lt;= range.e.c; ++C) &#123;</span><br><span class="line">        /* walk every column in the range */</span><br><span class="line">        const cell = sheet[XLSX.utils.encode_cell(&#123; c: C, r: R &#125;)]</span><br><span class="line">        /* find the cell in the first row */</span><br><span class="line">        let hdr = &#x27;UNKNOWN &#x27; + C // &lt;-- replace with your desired default</span><br><span class="line">        if (cell &amp;&amp; cell.t) hdr = XLSX.utils.format_cell(cell)</span><br><span class="line">        headers.push(hdr)</span><br><span class="line">      &#125;</span><br><span class="line">      return headers</span><br><span class="line">    &#125;,</span><br><span class="line">    isExcel(file) &#123;</span><br><span class="line">      return /\.(xlsx|xls|csv)$/.test(file.name)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.upload-excel &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  margin-top: 100px;</span><br><span class="line">  .excel-upload-input &#123;</span><br><span class="line">    display: none;</span><br><span class="line">    z-index: -9999;</span><br><span class="line">  &#125;</span><br><span class="line">  .btn-upload,</span><br><span class="line">  .drop &#123;</span><br><span class="line">    border: 1px dashed #bbb;</span><br><span class="line">    width: 350px;</span><br><span class="line">    height: 160px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    line-height: 160px;</span><br><span class="line">  &#125;</span><br><span class="line">  .drop &#123;</span><br><span class="line">    line-height: 80px;</span><br><span class="line">    color: #bbb;</span><br><span class="line">    i &#123;</span><br><span class="line">      font-size: 60px;</span><br><span class="line">      display: block;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-3-注册全局的导入excel组件-components-x2F-index-js"><a href="#2-3-注册全局的导入excel组件-components-x2F-index-js" class="headerlink" title="2.3 注册全局的导入excel组件 (components&#x2F;index.js)"></a>2.3 注册全局的导入excel组件 (components&#x2F;index.js)</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PageTools</span> <span class="keyword">from</span> <span class="string">&#x27;./PageTools&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UploadExcel</span> <span class="keyword">from</span> <span class="string">&#x27;./UploadExcel&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">Vue</span>) &#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;PageTools&#x27;</span>, <span class="title class_">PageTools</span>) <span class="comment">// 注册工具栏组件</span></span><br><span class="line">    <span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;UploadExcel&#x27;</span>, <span class="title class_">UploadExcel</span>) <span class="comment">// 注册导入excel组件</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-excel导入步骤"><a href="#3-excel导入步骤" class="headerlink" title="3 excel导入步骤"></a>3 excel导入步骤</h2><h3 id="3-1-建立公共导入的页面路由-（router-x2F-index-js）"><a href="#3-1-建立公共导入的页面路由-（router-x2F-index-js）" class="headerlink" title="3.1 建立公共导入的页面路由 （router&#x2F;index.js）"></a>3.1 建立公共导入的页面路由 （router&#x2F;index.js）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// excel导入的路由</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="attr">path</span>: <span class="string">&#x27;/import&#x27;</span>,</span><br><span class="line">   <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">   <span class="attr">hidden</span>: <span class="literal">true</span>, <span class="comment">// 在左侧栏中隐藏</span></span><br><span class="line">   <span class="attr">children</span>: [&#123;</span><br><span class="line">     <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">     <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;@/views/import&#x27;</span>),</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;Import&#x27;</span>,</span><br><span class="line">     <span class="attr">meta</span>: &#123;</span><br><span class="line">       <span class="attr">title</span>: <span class="string">&#x27;文件导入&#x27;</span> <span class="comment">// 左侧导航会读取我们的路由里的meta里面的title作为显示菜单名称</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;]</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="3-2-创建import路由组件-src-views-import-index-vue"><a href="#3-2-创建import路由组件-src-views-import-index-vue" class="headerlink" title="3.2 创建import路由组件  src/views/import/index.vue"></a>3.2 创建import路由组件  <strong><code>src/views/import/index.vue</code></strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 公共导入组件 --&gt; </span><br><span class="line">  &lt;upload-excel :on-success=&quot;success&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-3-封装批量导入接口-api-x2F-schools-js"><a href="#3-3-封装批量导入接口-api-x2F-schools-js" class="headerlink" title="3.3 封装批量导入接口 api&#x2F;schools.js"></a>3.3 封装批量导入接口 api&#x2F;schools.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 批量新增学校信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">importSchoolInfo</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/school/addBatch&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-实现excel导入"><a href="#3-4-实现excel导入" class="headerlink" title="3.4 实现excel导入"></a>3.4 实现excel导入</h3><p>使用type类型，区分不同的批量导入请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 引入公共Excel导入组件 --&gt;</span><br><span class="line">  &lt;upload-excel :on-success=&quot;success&quot; /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; importSchoolInfo &#125; from &#x27;@/api/school&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;Import&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      // 为了让这个页面可以服务更多的导入功能，我们可以在页面中用参数来判断</span><br><span class="line">      type: this.$route.query.type</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    async success(&#123; header, results &#125;) &#123;</span><br><span class="line">      console.log(&#x27;success type&#x27;, this.$route.query)</span><br><span class="line">      if (this.type === undefined) &#123;</span><br><span class="line">        this.$message.error(&#x27;请关闭当前页面，重新进入&#x27;)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 如果是导入员工</span><br><span class="line">        if (this.type === &#x27;schoolBasicInfo&#x27;) &#123;</span><br><span class="line">          const schoolInfoRelations = &#123;</span><br><span class="line">            学校编号: &#x27;school_id&#x27;,</span><br><span class="line">            学校名: &#x27;school_name&#x27;,</span><br><span class="line">            学校等级: &#x27;school_level&#x27;,</span><br><span class="line">            学校类型: &#x27;school_type&#x27;,</span><br><span class="line">            办学性质: &#x27;school_nature&#x27;,</span><br><span class="line">            区域: &#x27;school_region&#x27;,</span><br><span class="line">            省份: &#x27;school_province&#x27;,</span><br><span class="line">            城市: &#x27;school_city&#x27;,</span><br><span class="line">            是否211: &#x27;school_211&#x27;,</span><br><span class="line">            是否985: &#x27;school_985&#x27;,</span><br><span class="line">            隶属单位: &#x27;school_belong&#x27;,</span><br><span class="line">            最新软科排名: &#x27;school_rk&#x27;,</span><br><span class="line">            最新校友会排名: &#x27;school_xyh&#x27;,</span><br><span class="line">            最新武书连排名: &#x27;school_wsl&#x27;,</span><br><span class="line">            最新QS排名: &#x27;school_qs&#x27;,</span><br><span class="line">            最新US排名: &#x27;school_us&#x27;,</span><br><span class="line">            最新泰晤士排名: &#x27;school_tws&#x27;,</span><br><span class="line">            报考要求: &#x27;school_requirments&#x27;</span><br><span class="line">          &#125;</span><br><span class="line">          const arr = []</span><br><span class="line">          results.forEach((item) =&gt; &#123;</span><br><span class="line">            const userInfo = &#123;&#125;</span><br><span class="line">            Object.keys(item).forEach((key) =&gt; &#123;</span><br><span class="line">              userInfo[schoolInfoRelations[key]] = item[key]</span><br><span class="line">            &#125;)</span><br><span class="line">            arr.push(userInfo)</span><br><span class="line">          &#125;)</span><br><span class="line">          const &#123; data &#125; = await importSchoolInfo(arr) // 调用导入接口</span><br><span class="line">          if (data.code === 200) &#123;</span><br><span class="line">            this.$message.success(&#x27;批量新增学校基本信息成功！&#x27;)</span><br><span class="line">          &#125;</span><br><span class="line">          // 跳转回到上一个页面</span><br><span class="line">          this.$router.back()</span><br><span class="line">          // 将信息导入页面从openPages中删除，即关闭导入页面的tagsView</span><br><span class="line">          this.$store.commit(&#x27;tagsView/REMOVE_PAGE&#x27;, &#x27;/import&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-5-在学校界面，点击”导入”按钮，实现批量导入。传入type类型"><a href="#3-5-在学校界面，点击”导入”按钮，实现批量导入。传入type类型" class="headerlink" title="3.5 在学校界面，点击”导入”按钮，实现批量导入。传入type类型"></a>3.5 在学校界面，点击”导入”按钮，实现批量导入。传入type类型</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-button type=&quot;warning&quot; @click=&quot;$router.push(&#x27;/import?type=schoolBasicInfo&#x27;)&quot;</span><br><span class="line">&gt;导入&lt;/el-button&gt;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/15/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86-%E5%AD%90%E7%BB%84%E4%BB%B6%E5%9C%A8create%E3%80%81mounted%E4%B8%AD%E6%8E%A5%E5%8F%97%E4%B8%8D%E5%88%B0%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E6%9D%A5%E7%9A%84%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/15/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86-%E5%AD%90%E7%BB%84%E4%BB%B6%E5%9C%A8create%E3%80%81mounted%E4%B8%AD%E6%8E%A5%E5%8F%97%E4%B8%8D%E5%88%B0%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E6%9D%A5%E7%9A%84%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">项目知识 - 子组件在create、mounted中接受不到父组件传来的异步数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-15 09:30:11" itemprop="dateCreated datePublished" datetime="2022-07-15T09:30:11+08:00">2022-07-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="子组件在create、mounted中接受不到父组件传来的异步数据"><a href="#子组件在create、mounted中接受不到父组件传来的异步数据" class="headerlink" title="子组件在create、mounted中接受不到父组件传来的异步数据"></a>子组件在create、mounted中接受不到父组件传来的异步数据</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>vue中父组件异步数据通过props方式传递给子组件，子组件接收不到的问题 [<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43290151/article/details/124954767]">https://blog.csdn.net/weixin_43290151/article/details/124954767]</a></li>
<li>Vue生命周期详解 [<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45054614/article/details/122178368]">https://blog.csdn.net/weixin_45054614/article/details/122178368]</a></li>
</ol>
<h2 id="问题来源"><a href="#问题来源" class="headerlink" title="问题来源"></a>问题来源</h2><p>最近在写项目结构时候遇到了这个问题，项目结构如下：父组件地理信息&#x2F;index.js中包含三个子组件：区域组件、省份组件、城市组件。</p>
<p>需求：在index.js中通过后端接口获取所有区域信息、再遍历每个区域，获取区域下的省份，组成所有省份信息。将所有区域信息传递给省份组件用于显示每个区域下有哪些省份，所有省份信息传递给城市组件用于显示每个省份下有哪些城市。遇到了问题：城市组件在页面渲染时候获取不到父组件传来的数据。</p>
<h2 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h2><p>由于所有省份信息是在index.js页面以后端请求的方式异步获取的，根据父子组件的生命周期流程，父组件要等子组件的生命周期走完，即子组件mounted完后，父组件才会mounted。而mounted钩子默认加载只会执行一次，子组件的mounted钩子执行的时候，父组件的异步数据还没有传递过来。</p>
<h2 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h2><h4 id="方案一-使用v-if控制子组件渲染的时机"><a href="#方案一-使用v-if控制子组件渲染的时机" class="headerlink" title="方案一 使用v-if控制子组件渲染的时机"></a>方案一 使用v-if控制子组件渲染的时机</h4><h5 id="父组件"><a href="#父组件" class="headerlink" title="父组件"></a>父组件</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-tab-pane</span> <span class="attr">label</span>=<span class="string">&quot;城市信息管理&quot;</span> <span class="attr">name</span>=<span class="string">&quot;third&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">City</span> <span class="attr">v-if</span>=<span class="string">&quot;allprovinces.length !== 0&quot;</span> <span class="attr">:allprovinces</span>=<span class="string">&quot;allprovinces&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-tab-pane</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="子组件"><a href="#子组件" class="headerlink" title="子组件"></a>子组件</h5><blockquote>
<p> 这种方式，子组件不用动代码，在父组件中去做控制即可</p>
</blockquote>
<p>但是这种方式有一个小小的缺点，就是最终效果会显得组件有些延迟才出现效果。因为异步数据是从后端的接口获取的，如果接口时间长一些的话，最终效果渲染也会慢一点，但是！！！一般情况下，后端的接口速度都会控制在几十到几百毫秒的时间，一般情况下，不会出现好几秒，甚至几十秒的接口，所以瑕不掩瑜，这种方式不影响我们使用</p>
<h4 id="方案二-子组件使用watch监听父组件传递过来的数据"><a href="#方案二-子组件使用watch监听父组件传递过来的数据" class="headerlink" title="方案二 子组件使用watch监听父组件传递过来的数据"></a>方案二 子组件使用watch监听父组件传递过来的数据</h4><h5 id="父组件-1"><a href="#父组件-1" class="headerlink" title="父组件"></a>父组件</h5><p>这种方式父组件正常传递数据即可，不需要做什么代码处理，只要在子组件中加一个监听即可</p>
<h5 id="子组件-1"><a href="#子组件-1" class="headerlink" title="子组件"></a>子组件</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">allprovince</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="literal">null</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="comment">// 监听到父组件传递过来的数据后，加工一下，</span></span><br><span class="line">    <span class="comment">// 存到data中去，然后在页面上使用</span></span><br><span class="line">    <span class="title function_">allprovince</span>(<span class="params">newnew, oldold</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;监听&quot;</span>, newnew, oldold)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">allprovince_total</span> = newnew</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">allprovince_total</span>: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="相关知识"><a href="#相关知识" class="headerlink" title="相关知识"></a>相关知识</h2><h3 id="Vue生命周期"><a href="#Vue生命周期" class="headerlink" title="Vue生命周期"></a>Vue生命周期</h3><img src="/2022/07/15/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86-%E5%AD%90%E7%BB%84%E4%BB%B6%E5%9C%A8create%E3%80%81mounted%E4%B8%AD%E6%8E%A5%E5%8F%97%E4%B8%8D%E5%88%B0%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E6%9D%A5%E7%9A%84%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE/vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" class="" title="vue生命周期">

<h3 id="父子组件生命周期执行顺序"><a href="#父子组件生命周期执行顺序" class="headerlink" title="父子组件生命周期执行顺序"></a>父子组件生命周期执行顺序</h3><p>加载渲染数据过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">父组件 beforeCreate --&gt;</span><br><span class="line">父组件 created --&gt;</span><br><span class="line">父组件 beforeMount --&gt;</span><br><span class="line">子组件 beforeCreate --&gt;</span><br><span class="line">子组件 created --&gt;</span><br><span class="line">子组件 beforeMount --&gt;</span><br><span class="line">子组件 mounted --&gt;</span><br><span class="line">父组件 mounted --&gt;</span><br></pre></td></tr></table></figure>

<p>更新渲染数据过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">父组件 beforeUpdate --&gt;</span><br><span class="line">子组件 beforeUpdate --&gt;</span><br><span class="line">子组件 updated --&gt;</span><br><span class="line">父组件 updated --&gt;</span><br></pre></td></tr></table></figure>

<p>销毁组件数据过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">父组件 beforeDestroy --&gt;</span><br><span class="line">子组件 beforeDestroy --&gt;</span><br><span class="line">子组件 destroyed --&gt;</span><br><span class="line">父组件 destroyed</span><br></pre></td></tr></table></figure>

<p>可以这样理解，父组件生命周期中会先看看子组件的生命周期有没有走完，<code>子组件生命周期走完了，才会走完父组件的生命周期</code>。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/14/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%862-vuex%E7%9A%84%E4%BD%BF%E7%94%A8%E3%80%81action%E5%92%8Cmutation%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/14/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%862-vuex%E7%9A%84%E4%BD%BF%E7%94%A8%E3%80%81action%E5%92%8Cmutation%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">项目知识2 - vuex的使用、action和mutation的区别</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-14 21:02:08" itemprop="dateCreated datePublished" datetime="2022-07-14T21:02:08+08:00">2022-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA/" itemprop="url" rel="index"><span itemprop="name">项目查漏补缺</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="vuex的使用、action和mutation的区别"><a href="#vuex的使用、action和mutation的区别" class="headerlink" title="vuex的使用、action和mutation的区别"></a>vuex的使用、action和mutation的区别</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>action和mutation区别 [<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f9213af4bcb1]">https://www.jianshu.com/p/f9213af4bcb1]</a></li>
</ol>
<h2 id="action和mutation的区别"><a href="#action和mutation的区别" class="headerlink" title="action和mutation的区别"></a>action和mutation的区别</h2><blockquote>
<p>action中处理业务代码、异步请求。不能操作State</p>
<p>mutation专注于修改State，理论上是修改State的唯一途径。必须同步执行</p>
</blockquote>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>定义action</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="comment">//  获取异步的数据 context表示当前的store的实例 可以通过 context.state 获取状态 也可以通过context.commit 来提交mutations， 也可以 context.diapatch调用其他的action</span></span><br><span class="line">    getAsyncCount (context) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// 一秒钟之后 要给一个数 去修改state</span></span><br><span class="line">        context.<span class="title function_">commit</span>(<span class="string">&#x27;addCount&#x27;</span>, <span class="number">123</span>)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure>







<h2 id="项目应用"><a href="#项目应用" class="headerlink" title="项目应用"></a>项目应用</h2><p>由于地理信息（所有区域、省份、城市）在多个页面都需要获取，如果每个页面都通过请求获取，会重复多次请求同一个地址，导致项目加载效率低。因此采用vuex获取所有地理信息，并保存。每次使用的时候先从state中进行获取，如果state中没有信息再调用请求获取。</p>
<h4 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h4><p>获取所有区域信息</p>
<ul>
<li>如果state.regions为空，则自行通过get请求获取所有Regions，并使用setRegions 设置 regions的值</li>
<li>每次update、delete、insert后，都要通过get请求重新获取所有Regions</li>
</ul>
<p>获取所有省份信息</p>
<ul>
<li>setRegions 设置 regions的值后需要重新获取所有省份信息</li>
<li>编辑省份后需要重新获取所有省份信息</li>
</ul>
<p>获取所有城市信息</p>
<ul>
<li>setRegions 设置 regions的值后需要重新获取城市信息</li>
<li>编辑城市后需要重新获取</li>
</ul>
<p>编辑区域信息后，需要重新获取所有区域、省份、城市</p>
<p>编辑省份后，需要重新所有省份、城市</p>
<p>编辑城市后，需要重新获取所有城市</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/14/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%861-route%E5%92%8C-router%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/14/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%861-route%E5%92%8C-router%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">项目知识1 - $route和$router的区别</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-14 19:01:41" itemprop="dateCreated datePublished" datetime="2022-07-14T19:01:41+08:00">2022-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%A1%B9%E7%9B%AE%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">项目知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="route和-router的区别"><a href="#route和-router的区别" class="headerlink" title="$route和$router的区别"></a>$route和$router的区别</h2><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li>this.$route和this.$router的区别 [<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/26631cff7649?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation%5D">https://www.jianshu.com/p/26631cff7649?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation]</a></li>
</ol>
<h3 id="问题起源"><a href="#问题起源" class="headerlink" title="问题起源"></a>问题起源</h3><p>最近在做el-tab实现多页签的功能，需要通过$route判断当前路由，$router.push(path) 实现路由跳转，$router.back() 返回上一个路由。</p>
<h3 id="1-1-route对象"><a href="#1-1-route对象" class="headerlink" title="1.1 $route对象"></a>1.1 $route对象</h3><p>表示当前激活的路由的状态信息，包含了当前 URL 解析得到的信息，还有 URL 匹配到的 route records（路由记录）。<br><code>$router会被自动注入每个组件中</code>，可以直接利用它进行一些信息的获取。即this.$route来调用。</p>
<h3 id="1-2-route对象出现地方"><a href="#1-2-route对象出现地方" class="headerlink" title="1.2 $route对象出现地方"></a>1.2 $route对象出现地方</h3><ul>
<li><p>在组件内，直接通过 this.$route来调用。前提全局注册路由插件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 可以在项目中使用vue.use()全局注入一个插件，从而不需要在每个组件文件中import插件。</p>
<p>使用了vue.use()注册插件之后就可以在所有的vue文件中使用路由：this.$route</p>
</blockquote>
</li>
<li><p>在导航守卫的参数内</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// to 和 from 都是 路由信息对象</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  $route(to, <span class="keyword">from</span>) &#123;</span><br><span class="line">     <span class="comment">// to 和 from 都是 路由信息对象</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-1-router对象"><a href="#2-1-router对象" class="headerlink" title="2.1 $router对象"></a>2.1 $router对象</h3><p>全局的路由实例，是router构造方法的实例。需要在router&#x2F;index.js 中使用vue-router库进行创建</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createRouter</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">    <span class="attr">routes</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;@/views/login/index&#x27;</span>),</span><br><span class="line">            <span class="attr">hidden</span>: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/404&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;@/views/404&#x27;</span>),</span><br><span class="line">            <span class="attr">hidden</span>: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出router对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-2-其他组件中使用router对象需要先引入"><a href="#2-2-其他组件中使用router对象需要先引入" class="headerlink" title="2.2 其他组件中使用router对象需要先引入"></a>2.2 其他组件中使用router对象需要先引入</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在其他组件中使用路由对象 , 自动以 router/index.js 作为入口</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span> </span><br></pre></td></tr></table></figure>

<h3 id="2-3-路由实例方法push"><a href="#2-3-路由实例方法push" class="headerlink" title="2.3 路由实例方法push"></a>2.3 路由实例方法push</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字符串</span></span><br><span class="line">      <span class="keyword">this</span>.$router.push(<span class="string">&#x27;home&#x27;</span>)</span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line">      <span class="keyword">this</span>.$router.push(&#123; path: <span class="string">&#x27;home&#x27;</span> &#125;)</span><br><span class="line"><span class="comment">// 命名的路由</span></span><br><span class="line">      <span class="keyword">this</span>.$router.push(&#123; name: <span class="string">&#x27;user&#x27;</span>, params: &#123; userId: <span class="number">123</span> &#125;&#125;)</span><br><span class="line"><span class="comment">// 带查询参数，变成 /register?plan=123</span></span><br><span class="line">      <span class="keyword">this</span>.$router.push(&#123; path: <span class="string">&#x27;register&#x27;</span>, query: &#123; plan: <span class="string">&#x27;123&#x27;</span> &#125;&#125;)</span><br></pre></td></tr></table></figure>

<p><code>push方法其实和&lt;router-link :to=&quot;...&quot;&gt;是等同的</code>。<br> <em>注意：push方法的跳转会向 history 栈添加一个新的记录，当我们点击浏览器的返回按钮时可以看到之前的页面。</em></p>
<h3 id="2-4-路由实例方法go"><a href="#2-4-路由实例方法go" class="headerlink" title="2.4  路由实例方法go"></a>2.4  路由实例方法go</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 页面路由跳转 前进或者后退</span></span><br><span class="line"><span class="keyword">this</span>.$router.go(-<span class="number">1</span>) <span class="comment">// 后退</span></span><br></pre></td></tr></table></figure>

<h3 id="2-5-路由实例方法replace"><a href="#2-5-路由实例方法replace" class="headerlink" title="2.5 路由实例方法replace"></a>2.5 路由实例方法replace</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//push方法会向 history 栈添加一个新的记录，而replace方法是替换当前的页面，</span></span><br><span class="line">不会向 history 栈添加一个新的记录</span><br><span class="line"></span><br><span class="line">&lt;router-link to=<span class="string">&quot;/05&quot;</span> replace&gt;<span class="number">05</span>&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一般使用replace来做404页面</span></span><br><span class="line"><span class="keyword">this</span>.$router.replace(<span class="string">&#x27;/&#x27;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://1katherine.github.io/2022/07/14/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%AD%A6%E4%B9%A01-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yang's Blog">
      <meta itemprop="description" content="Yang的博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Yang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/14/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%AD%A6%E4%B9%A01-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F/" class="post-title-link" itemprop="url">前端面试学习1 - 浏览器跨域</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-14 15:04:57" itemprop="dateCreated datePublished" datetime="2022-07-14T15:04:57+08:00">2022-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-28 10:45:29" itemprop="dateModified" datetime="2022-07-28T10:45:29+08:00">2022-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">前端面试题</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="浏览器跨域"><a href="#浏览器跨域" class="headerlink" title="浏览器跨域"></a>浏览器跨域</h1><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://febook.hzfe.org/awesome-interview/book1/browser-cross-origin">剑指前端Offer</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/hdchangchang/article/details/80112593">webpack之devServer配置</a></li>
</ol>
<h2 id="相关问题"><a href="#相关问题" class="headerlink" title="相关问题"></a>相关问题</h2><ol>
<li>什么是跨域？</li>
<li>为什么会跨域？</li>
<li>为什么有跨域限制？</li>
</ol>
<h2 id="回答关键点"><a href="#回答关键点" class="headerlink" title="回答关键点"></a>回答关键点</h2><ol>
<li>浏览器有跨域限制，服务端没有跨域</li>
<li><strong>浏览器</strong>为了<strong>请求安全</strong>而引入的<strong>基于同源策略</strong>的安全特性</li>
</ol>
<h2 id="判定跨域"><a href="#判定跨域" class="headerlink" title="判定跨域"></a>判定跨域</h2><p>当页面和请求的协议（https）、主机（localhost）或端口（8080）不同时，浏览器判定两者不同源，从而产生跨域。</p>
<img src="/2022/07/14/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%AD%A6%E4%B9%A01-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B7%A8%E5%9F%9F/image-20220714151119753.png" class="" title="image-20220714151119753">



<h3 id="跨域的解决方案"><a href="#跨域的解决方案" class="headerlink" title="跨域的解决方案"></a>跨域的解决方案</h3><h4 id="1-CORS-Cross-Origin-Resource-Sharing"><a href="#1-CORS-Cross-Origin-Resource-Sharing" class="headerlink" title="1.CORS (Cross-Origin Resource Sharing)"></a>1.CORS (Cross-Origin Resource Sharing)</h4><p>CORS 是目前最为广泛的解决跨域问题的方案。方案依赖<strong>服务端&#x2F;后端在响应头中添加</strong> <code>Access-Control-Allow-*</code> 头，告知浏览器端通过此请求。</p>
<h4 id="2-反向代理"><a href="#2-反向代理" class="headerlink" title="2.反向代理"></a>2.反向代理</h4><p>反向代理解决跨域问题的方案依赖<code>同源的服务端对请求做一个转发处理</code>，将请求从跨域请求转换成同源请求。</p>
<h5 id="vue实现反向代理的具体实现方式"><a href="#vue实现反向代理的具体实现方式" class="headerlink" title="vue实现反向代理的具体实现方式"></a>vue实现反向代理的具体实现方式</h5><p>vue.config.js</p>
<blockquote>
<p>DevServer 是webpack开发服务器</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">  <span class="comment">// 代理配置 - 解决跨域问题（前端和后端接口不在同一域名下</span></span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;0.0.0.0&#x27;</span>,</span><br><span class="line">  <span class="attr">port</span>: port,</span><br><span class="line">  <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">overlay</span>: &#123;</span><br><span class="line">    <span class="attr">warnings</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">errors</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">proxy</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">      <span class="attr">target</span>: <span class="string">&#x27;http://192.168.1.13:8080&#x27;</span>, <span class="comment">// 后端接口</span></span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>, <span class="comment">// 是否跨域</span></span><br><span class="line">      <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>理解</p>
<blockquote>
<p>使用本地服务端代理跨域的API后端开发服务器。</p>
</blockquote>
<ul>
<li>假设你主机名为 localhost:8080 , 请求 API 的 url 是 <code>http://192.168.1.13:8080/user/list</code></li>
<li>‘&#x2F;api：如果点击某个按钮，触发请求 <em>API</em> 事件，这时请求 <em>url</em> 是<code>http://localhost:8080/api/user/list</code></li>
<li>changeOrigin：如果 true ，那么 <code>http://localhost:8080/api/user/list</code>变为 <code>http://192.168.1.13:8080/api/user/list</code> 。但还不是我们要的 url</li>
<li>pathRewrite：重写路径。匹配 &#x2F;api ，然后变为’’ ，那么 url 最终为 <code>http://192.168.1.13:8080/user/list </code>。</li>
</ul>
<p>总结：本地浏览器请求同源的服务端 <code>http://localhost:8080/api/user/list</code>,本地服务端请求API后端开发服务器，并且根据重写路径，用空字段代替&#x2F;api字段，最终请求到实际的后端开发服务器 <code>http://192.168.1.13:8080/user/list </code></p>
<p>创建axois实例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个axios实例</span></span><br><span class="line"><span class="keyword">const</span> service = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;/api&#x27;</span>, <span class="comment">// 设置axios请求的基础的基础地址(通过/api别名指定后端路由)</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span> <span class="comment">// 定义5秒超时</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





</body>
</html>
